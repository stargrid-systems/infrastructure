variant: flatcar
version: 1.1.0

systemd:
  units:
  - name: var-lib-docker.mount
    enabled: true
    contents: |
      [Unit]
      Description=Mount ephemeral to /var/lib/docker
      Before=local-fs.target
      [Mount]
      What=/dev/disk/by-label/ephemeral1
      Where=/var/lib/docker
      Type=ext4
      [Install]
      WantedBy=local-fs.target

  - name: docker.service
    dropins:
    - name: 10-wait-docker.conf
      contents: |
        [Unit]
        After=var-lib-docker.mount
        Requires=var-lib-docker.mount
